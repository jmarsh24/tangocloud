<% cache(@playlist) do %>
  <% content_for :meta_tags do %>
    <!-- Meta Tags for Social Media Sharing -->
    <meta property="og:title" content="<%= @playlist.title %>">
    <meta property="og:description" content="<%= @playlist.description.presence || 'Listen to this playlist curated just for you.' %>">
    <% if @playlist.image.attached? %>
      <meta property="og:image" content="<%= url_for(@playlist.image) %>">
    <% end %>
    <meta property="og:type" content="music.playlist">
    <meta property="og:url" content="<%= playlist_url(@playlist) %>">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= @playlist.title %>">
    <meta name="twitter:description" content="<%= @playlist.description.presence || 'Listen to this playlist curated just for you.' %>">
    <% if @playlist.image.attached? %>
      <meta name="twitter:image" content="<%= url_for(@playlist.image) %>">
    <% end %>
  <% end %>
  <div class="relative flex flex-col gap-2 items-center dark:bg-black">
    <!-- Back to Music Library Button -->
    <%= link_to music_library_path, class: "absolute left-4 top-4 flex items-center gap-2 p-2 rounded-full bg-neutral-200 text-sm text-neutral-700 dark:bg-neutral-800 dark:text-neutral-400 hover:bg-neutral-300 dark:hover:bg-neutral-700" do %>
      <%= heroicon "chevron-left", size: :sm, class: "text-neutral-500 dark:text-neutral-400" %>
    <% end %>
    <!-- Playlist Image and Title -->
    <% if @playlist.image.attached? %>
      <%= image_tag @playlist.image, class: "w-64 h-64 md:w-24 md:h-24 rounded-lg object-cover shadow-md" %>
    <% end %>
    <h1 class="text-2xl font-bold dark:text-neutral-300"><%= @playlist.title %></h1>
    <!-- Playlist Description and Owner Info -->
    <% if @playlist.description.present? %>
      <p class="text-sm text-center dark:text-neutral-400"><%= @playlist.description %></p>
    <% end %>
    <% if @playlist.user %>
      <p class="text-sm text-center dark:text-neutral-400"><%= @playlist.user.username || @playlist.user.email %></p>
    <% end %>
    <%= button_to 'Add to Library', add_to_library_playlist_path(@playlist), method: :post, class: "btn btn-primary" %>
    <% if policy(@playlist).add_to? %>
      <%= link_to "Add to Playlist", add_to_playlist_path(@playlist), class: "btn btn-secondary", data: {turbo_frame: "modal"} %>
    <% end %>
    <div class="flex w-full flex-col gap-4">
      <%= render collection: @playlist_items, partial: "playlists/playlist_item" %>
    </div>
  </div>
<% end %>